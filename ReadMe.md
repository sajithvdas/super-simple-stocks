Super Simple Stocks Assignment

Requirements

The Global Beverage Corporation Exchange (GCBE) is a new stock market trading in drinks companies. a. Your company is building the object-oriented system to run that trading. b. You have been assigned to build part of the core object model for a limited phase 1
Provide complete source code that will:- a. For a given stock, I. Given any price as input, calculate the dividend yield II. Given any price as input, calculate the P/E Ratio III. Record a trade, with timestamp, quantity, buy or sell indicator and price IV. Calculate Volume Weighted Stock Price based on trades in past 5 minutes b. Calculate the GBCE All Share Index using the geometric mean of the Volume Weighted Stock Price for all stocks
Constrains & Notes

Written in one of these languages - Java, C#, C++, Python
The source code should be suitable for forming part of the object model of a production application, and can be proven to meet the requirements.
No database, GUI or I/O is required, all data need only be held in memory.
No prior knowledge of stock markets or trading is required â€“ all formulas are provided below.
The code should provide only the functionality requested, however must be production quality.